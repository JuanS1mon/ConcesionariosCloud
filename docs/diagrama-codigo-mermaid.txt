flowchart TD
    %% Clientes y Canales de Entrada
    A[ğŸ‘¤ Cliente] --> B{ğŸ“ Â¿CÃ³mo contacta?}
    B -->|ğŸŒ Sitio Web| C[ğŸ“ Formulario Web]
    B -->|ğŸ’¬ WhatsApp| D[ğŸ’¬ Chat WhatsApp]
    B -->|ğŸ“ Llamada| E[ğŸ“ AtenciÃ³n TelefÃ³nica]
    B -->|ğŸ¢ Presencial| F[ğŸ¢ Showroom]

    %% RecepciÃ³n de Consulta
    C --> G[ğŸ“¨ RecepciÃ³n de Consulta]
    D --> G
    E --> G
    F --> G

    G --> H{ğŸ” Â¿Auto especÃ­fico?}
    H -->|âœ… SÃ­| I[ğŸ” Buscar Auto en Inventario]
    H -->|âŒ No| J[ğŸ“‹ Mostrar CatÃ¡logo/General]

    %% BÃºsqueda y Pricing
    I --> K{ğŸ“Š Â¿Auto encontrado?}
    K -->|âœ… SÃ­| L[ğŸ“„ Obtener Datos del Auto]
    K -->|âŒ No| M[ğŸª Buscar en Mercado/Proveedores]

    L --> N[ğŸ§  Pricing Engine]
    N --> O[ğŸ’° Calcular Precio Sugerido]
    O --> P[ğŸ“ˆ Obtener Comparables]
    P --> Q[â±ï¸ Simulador de Ventas]
    Q --> R[ğŸ“Š Estimar Tiempo de Venta]

    %% GeneraciÃ³n de CotizaciÃ³n
    O --> S[ğŸ“„ Generar CotizaciÃ³n]
    R --> S
    M --> S

    S --> T[ğŸ’¾ Crear Registro CotizaciÃ³n]
    T --> U[(ğŸ—„ï¸ Base de Datos<br/>cotizaciones)]

    %% ComunicaciÃ³n con Cliente
    S --> V{ğŸ“¤ Â¿Canal original?}
    V -->|ğŸŒ Web| W[ğŸ“§ Enviar Email + PDF]
    V -->|ğŸ’¬ WhatsApp| X[ğŸ’¬ Enviar mensaje + PDF]
    V -->|ğŸ“ TelÃ©fono| Y[ğŸ“ Llamar y explicar]
    V -->|ğŸ¢ Presencial| Z[ğŸ“„ Entregar fÃ­sicamente]

    %% Seguimiento y NegociaciÃ³n
    W --> AA[ğŸ“¬ Cliente Recibe CotizaciÃ³n]
    X --> AA
    Y --> AA
    Z --> AA

    AA --> BB{ğŸ’­ Â¿Interesado?}
    BB -->|âœ… SÃ­| CC[ğŸ¤ NegociaciÃ³n]
    BB -->|âŒ No| DD[âŒ Fin - No interesado]

    CC --> EE{ğŸ’° Â¿Negociar precio?}
    EE -->|âœ… SÃ­| FF[ğŸ›ï¸ Simulador Interactivo]
    EE -->|âŒ No| GG[âœ… Proceder con precio original]

    FF --> HH[ğŸ‘† Cliente ajusta precio]
    HH --> II[ğŸ”„ Recalcular tiempo/mÃ¡rgen]
    II --> JJ[ğŸ“Š Mostrar impacto]
    JJ --> KK{ğŸ‘ Â¿Acepta nuevo precio?}
    KK -->|âœ… SÃ­| GG
    KK -->|âŒ No| LL[ğŸ”„ NegociaciÃ³n continÃºa]

    %% Reserva y Compra
    GG --> MM[ğŸ›’ Cliente decide comprar]
    MM --> NN{ğŸ“ Â¿Reserva o compra directa?}

    NN -->|â³ Reserva| OO[ğŸ“… Crear Reserva]
    OO --> PP[(ğŸ—„ï¸ Base de Datos<br/>reservas)]
    PP --> QQ[âœ… Enviar confirmaciÃ³n]
    QQ --> RR[ğŸ’³ Esperar pago inicial]

    NN -->|ğŸ›’ Compra Directa| SS[âœ… Proceder a venta]

    RR --> TT{ğŸ’³ Pago realizado?}
    TT -->|âœ… SÃ­| SS
    TT -->|âŒ No| UU[â° Recordatorio pago]

    %% Proceso de Venta
    SS --> VV[ğŸ’¼ Crear Registro Venta]
    VV --> WW[(ğŸ—„ï¸ Base de Datos<br/>ventas)]

    VV --> XX[ğŸ“‹ Generar DocumentaciÃ³n]
    XX --> YY[ğŸ§¾ Factura]
    YY --> ZZ[ğŸ“„ Contrato]
    ZZ --> AAA[ğŸ“‘ Documentos Legales]

    XX --> BBB[ğŸ”„ Actualizar Inventario]
    BBB --> CCC[âœ… Marcar auto como vendido]
    CCC --> DDD[(ğŸ—„ï¸ Base de Datos<br/>autos)]

    %% Entrega
    AAA --> EEE[ğŸš› Coordinar Entrega]
    EEE --> FFF{âš¡ Â¿Entrega inmediata?}
    FFF -->|âœ… SÃ­| GGG[ğŸš— Entregar vehÃ­culo]
    FFF -->|âŒ No| HHH[ğŸ“… Agendar fecha entrega]

    HHH --> III[ğŸ“† Fecha programada]
    III --> GGG

    GGG --> JJJ[ğŸ™Œ Cliente recibe auto]
    JJJ --> KKK[âœ… Actualizar estado venta]
    KKK --> LLL[ğŸ‰ Completado]

    %% Sistema de Seguimiento
    subgraph "ğŸ“Š Sistema de Seguimiento"
        MMM[ğŸ“ˆ Dashboard Admin]
        MMM --> NNN[ğŸ‘€ Ver todas cotizaciones]
        MMM --> OOO[â³ Ver reservas pendientes]
        MMM --> PPP[âœ… Ver ventas completadas]
        MMM --> QQQ[ğŸ“Š MÃ©tricas de conversiÃ³n]
    end

    %% Integraciones
    subgraph "ğŸ”— Integraciones Externas"
        RRR[ğŸ–¼ï¸ Cloudinary<br/>ImÃ¡genes]
        SSS[ğŸ’¬ WhatsApp API<br/>Mensajes]
        TTT[ğŸ“§ Email Service<br/>Notificaciones]
        UUU[ğŸ‘¥ CRM<br/>Historial cliente]
    end

    %% Conexiones del sistema
    U --> MMM
    PP --> MMM
    WW --> MMM
    DDD --> MMM

    XX --> RRR
    X --> SSS
    W --> TTT
    AA --> UUU